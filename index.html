<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/astro.svg" />
    <link rel="stylesheet" href="/node_modules/reveal.js/dist/reveal.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Merriweather+Sans&display=swap" rel="stylesheet">
    <title>QuantStack</title>
    <style>
      .footer-left {
        position: absolute;
        bottom: 2%;
        left: 2%;
      }
      .circle-img-big {
        width: 200px !important;
        height: 200px !important;
        border-radius: 50% !important;
        object-fit: cover !important;
        display: block !important;
        margin: 0 auto !important;
      }
    </style>
  </head>
  <body>
    <script type="module" src="/src/main.ts"></script>
    <div id="common" style="z-index: 2;">
      <div class="footer-left">
        <div style="font-family: Source Sans Pro, Helvetica, sans-serif;">
          <img alt="GitHub" src="src/images/github.svg" height="20px"/>
          <p style="display: inline; vertical-align: top; margin-left: 4px; font-size: 20px;">@anutosh491 @JohanMabille @QuantStack</p>
        </div>
      </div>
    </div>
    <div class="reveal">
		<div class="slides">

<section data-background-image="./cosmo_victory.png" data-background-opacity="0.1">
  <h1> Swift in Jupyter</h1>
  <img src="/src/images/logo_scientific_computing.svg" alt="QuantStack Logo" class="title-logo">
</section>
<section>
  <h2>About</h2>
  <div class="two-column">
    <div class="column">
      <img src="src/images/Anutosh.png" alt="Anutosh profile picture" class="circle-img-big">
      <strong style="font-size: 1em">Anutosh Bhat</strong><br>
      <div style="text-align: centre">
        Software engineer at QuantStack<br>
        Contributes to the xeus stack<br>
        Maintains clang-repl<br>
      </div>
    </div>
    <div class="column">
      <img src="src/images/Julien.png" alt="Julien profile picture" class="circle-img-big">
      <strong style="font-size: 1em">Julien Jerphanion</strong><br>
      <div style="text-align: centre">
        Software engineer at QuantStack<br>
        Contributes to the mamba project<br>
        Maintains scikit-learn<br>
      </div>
    </div>
  </div>
</section>

<section>
  <h3 style="font-size:2.1em; margin:0 0 1em 0; text-align:left;">
    Inspiration for this work
  </h3>

  <div style="font-size:1.15em; line-height:1.6; text-align:left;">

    <p class="fragment fade-up" style="margin:0 0 .8em 0; font-size:1.05em;">
      Xeus-Cpp: The C/C++ kernel
    </p>

    <ul style="margin:0 0 1em 2em; padding:0; font-size:1.05em;">
      <li class="fragment fade-up">Native Kernel : Xeus-Cpp works on macos/linux/windows</li>
      <li class="fragment fade-up">Wasm Kernel : Xeus-Cpp-lite works entirely in your browser</li>
      <li class="fragment fade-up">Debugger Support for Xeus-Cpp</li>
    </ul>

  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.4em; font-weight:700; text-align:center; margin-bottom:0.8em;">
    Native Kernel
  </h2>

  <!-- Link -->
  <div style="text-align:center;">
    <a href="https://github.com/compiler-research/xeus-cpp/blob/main/notebooks/xeus-cpp.ipynb"
       target="_blank"
       style="font-size:1.4em; font-weight:600; color:#1a73e8; text-decoration:none;
              border:2px solid #1a73e8; padding:0.5em 1.2em; border-radius:8px;
              transition:all 0.2s ease-in-out;">
      🔗 Click here to open the example notebook
    </a>
  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.4em; font-weight:700; text-align:center; margin-bottom:0.8em;">
    WASM Kernel
  </h2>

  <!-- Link -->
  <div style="text-align:center;">
    <a href="https://compiler-research.org/xeus-cpp-wasm/lab/index.html"
       target="_blank"
       style="font-size:1.4em; font-weight:600; color:#1a73e8; text-decoration:none;
              border:2px solid #1a73e8; padding:0.5em 1.2em; border-radius:8px;
              transition:all 0.2s ease-in-out;">
      🔗 Click here to open the example notebook
    </a>
  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.2em; font-weight:700; text-align:center; margin-bottom:0.8em;">
    Debugger Support
  </h2>

  <!-- Video -->
  <div style="text-align:center; padding-bottom:2em;">
    <video src="src/images/Debugger-Demo.mp4"
           controls autoplay loop muted playsinline preload="metadata"
           style="width:65%; height:auto; display:block; margin:0 auto;
                  border-radius:10px; box-shadow:0 8px 32px rgba(0,0,0,.35);" >
      Your browser does not support the video tag.
    </video>
  </div>
</section>

<section>
  <h3 style="font-size:2.1em; margin:0 0 1em 0; text-align:left;">
    What is being proposed here
  </h3>

  <div style="font-size:1.15em; line-height:1.6; text-align:left;">

    <p class="fragment fade-up" style="margin:0 0 .8em 0; font-size:1.05em;">
      Xeus-Swift : The new swift Jupyter kernel
    </p>

    <ul style="margin:0 0 1em 2em; padding:0; font-size:1.05em;">
      <li class="fragment fade-up">Native Kernel : Xeus-Swift, expected to work on native platforms</li>
      <li class="fragment fade-up">Wasm Kernel : Xeus-Swift-lite works entirely in your browser</li>
      <li class="fragment fade-up">Debugger Support for Xeus-Swift</li>
    </ul>

  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.4em; font-weight:700; text-align:center; margin-bottom:0.6em;">
    Xeus Architecture
  </h2>

  <!-- Image (dlopen) -->
  <div style="text-align:center;">
    <img src="src/images/xeus_archi.svg"
         alt="dlopen flow"
         style="max-width:100%; max-height:100vh; display:inline-block; margin:0 auto;
                border-radius:10px; box-shadow:0 8px 28px rgba(0,0,0,.25);" />
  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.4em; font-weight:700; text-align:center; margin-bottom:1em;">
    Coming up with Xeus-Cpp
  </h2>

  <!-- Content -->
  <div style="background:#f5f5f5; padding:1.5em 2em; border-radius:10px; 
              max-width:85%; margin:0 auto; font-size:1.3em; line-height:1.8; color:#222;">
    <ul style="list-style-type: disc; padding-left:1.2em;">
      <li>
        The <strong>Interpreter</strong> and <strong>Debugger</strong> are well isolated —
        the kernel author must implement these components.
      </li>
    </ul>

    <hr style="margin:1.5em 0; border:none; border-top:1px solid #ddd;"/>

    <p style="font-weight:600; margin-bottom:0.5em;">For <strong>xeus-cpp</strong>:</p>
    <ul style="list-style-type: circle; padding-left:1.2em;">
      <li>
        <strong>Interpreter</strong> — Powered by LLVM’s <code>clang-repl</code> (the tool)
        / <code>libclangInterpreter.a</code> (the library)
      </li>
      <li>
        <strong>Debugger</strong> — Powered by <code>LLDB</code> and <code>LLDB-DAP</code>
      </li>
    </ul>
  </div>
</section>

<section>
  <h3 style="font-size:2.1em; margin:0 0 1em 0; text-align:left;">
    What we have in Swift
  </h3>

  <div style="font-size:1.15em; line-height:1.6; text-align:left;">

    <p class="fragment fade-up" style="margin:0 0 1em 0; font-size:1.02em;">
      An LLDB based REPL
    </p>

    <p class="fragment fade-up" style="margin:0 0 .8em 0; font-size:1.02em;">
      Downsides:
    </p>

    <ul style="margin:0 0 0 2em; padding:0; font-size:0.9em;">
      <li class="fragment fade-up">A debugger centric REPL</code></li>
      <li class="fragment fade-up">The wasm use cases</li>
    </ul>

  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.6em; font-weight:800; text-align:center; margin-bottom:0.6em;">
    Debugger Centric REPL
  </h2>

  <!-- Content -->
  <div style="background:#f8f8f8; padding:1.4em 2em; border-radius:12px;
              max-width:80%; margin:0 auto; font-size:1.35em; line-height:1.8; color:#222;
              box-shadow:0 4px 20px rgba(0,0,0,0.08);">
    
    <ul style="list-style-type: disc; padding-left:1.4em; margin:0;">
      <li style="margin-bottom:0.8em;">
        In the <strong>xeus architecture</strong>, the <strong>interpreter</strong> and 
        <strong>debugger</strong> are designed as <em>independent components</em> — 
        each handling a distinct request stream.
      </li>

      <li style="margin-bottom:0.8em;">
        The <strong>interpreter</strong> manages <em>code execution requests</em>, 
        while the <strong>debugger</strong> manages <em>cell debugging requests</em>, 
        ensuring that runtime execution and step-through debugging remain isolated.
      </li>

      <li>
        A <strong>compiler-centric REPL</strong> like <code>clang-repl</code> fits this model naturally — 
        providing a unified compilation context while keeping execution and debugging 
        pathways cleanly separated.
      </li>
    </ul>
  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.6em; font-weight:800; text-align:center; margin-bottom:0.6em;">
    Compiling lldb to wasm
  </h2>

  <!-- Content -->
  <div style="background:#f8f8f8; padding:1.4em 2em; border-radius:12px;
              max-width:80%; margin:0 auto; font-size:1.35em; line-height:1.8; color:#222;
              box-shadow:0 4px 20px rgba(0,0,0,0.08);">
    
    <ul style="list-style-type: disc; padding-left:1.4em; margin:0;">
      <li style="margin-bottom:0.8em;">
        Xeus-Cpp-lite that works entirely in the browser is powered by JupyterLite and wasm.
      </li>

      <li style="margin-bottom:0.8em;">
        So this involves compiling llvm, clang, clang-repl to emscripten-wasm32. Hosted on Emscripten-forge.
      </li>

      <li>
        Compiling LLDB to wasm doesn't make sense because on its dependency on system calls.
      </li>
    </ul>
  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.4em; font-weight:700; text-align:center; margin-bottom:0.6em;">
    Attempt compiling lldb to wasm
  </h2>

  <!-- Image (dlopen) -->
  <div style="text-align:center;">
    <img src="src/images/lldb_wasm.png"
         alt="dlopen flow"
         style="max-width:90%; max-height:90vh; display:inline-block; margin:0 auto;
                border-radius:10px; box-shadow:0 8px 28px rgba(0,0,0,.25);" />
  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.6em; font-weight:800; text-align:center; margin-bottom:0.4em;">
    Proposing a Compiler-Centric REPL
  </h2>

  <!-- Subheading -->
  <h3 style="font-size:1.6em; font-weight:600; text-align:center; color:#333; margin-bottom:1.2em;">
    Understanding <code>clang-repl</code> for Native Platforms
  </h3>

  <!-- Sequential Flow -->
  <div style="font-size:1.4em; text-align:left; color:#222; line-height:1.8; max-width:75%; margin:0 auto;">
    <p class="fragment fade-up"><code>input_line_X → PTU (Incremental AST)</code></p>
    <p class="fragment fade-up"><code>→ LLVM IR</code></p>
    <p class="fragment fade-up"><code>→ LLVM ORC JIT</code></p>
  </div>
</section>
<section>
  <!-- Title -->
  <h2 style="font-size:2.4em; font-weight:700; text-align:center; margin-bottom:0.6em;">
    Clang-repl on Native Platforms
  </h2>

  <!-- Image (dlopen) -->
  <div style="text-align:center;">
    <img src="src/images/clang_repl_native.png"
         alt="dlopen flow"
         style="max-width:90%; max-height:90vh; display:inline-block; margin:0 auto;
                border-radius:10px; box-shadow:0 8px 28px rgba(0,0,0,.25);" />
  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.6em; font-weight:800; text-align:center; margin-bottom:0.4em;">
    Proposing a Compiler-Centric REPL
  </h2>

  <!-- Subheading -->
  <h3 style="font-size:1.6em; font-weight:600; text-align:center; color:#333; margin-bottom:1.2em;">
    Understanding <code>clang-repl</code> for Wasm Platforms
  </h3>

  <!-- Sequential Flow -->
  <div style="font-size:1.4em; text-align:left; color:#222; line-height:1.8; max-width:75%; margin:0 auto;">
    <p class="fragment fade-up"><code>input_line_X → PTU (Incremental AST)</code></p>
    <p class="fragment fade-up"><code>→ LLVM IR</code></p>
    <p class="fragment fade-up"><code>→ incr_module_X.so → incr_module_X.wasm</code></p>
    <p class="fragment fade-up"><code>→ loaded on top of xeus-cpp.wasm using emscripten’s dlopen</code></p>
  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.6em; font-weight:800; text-align:center; margin-bottom:0.8em;">
    ClangInterpreter Design
  </h2>

  <!-- Content -->
  <div style="background:#f8f8f8; padding:1.8em 2.2em; border-radius:12px;
              max-width:80%; margin:0 auto; font-size:1.3em; line-height:1.9;
              color:#222; box-shadow:0 4px 20px rgba(0,0,0,0.08);">
    <ul style="list-style-type: disc; padding-left:1.5em;">
      <li class="fragment fade-up">
        <strong>clang-repl</strong> — uses <strong>Clang</strong> for frontend/parsing 
        and <strong>LLVM ORC JIT</strong> for execution.
      </li>
      <li class="fragment fade-up">
        The <strong>Interpreter</strong> class can be viewed as composed of two main components: 
        <strong>IncrementalParser</strong> and <strong>IncrementalExecutor</strong>.
      </li>
      <li class="fragment fade-up">
        <strong>IncrementalParser</strong> — manages the parser internally 
        and represents the “frontend” half of the interpreter.
      </li>
      <li class="fragment fade-up">
        <strong>IncrementalExecutor</strong> — manages the <strong>LLJIT</strong> for native platforms 
        or the <strong>WebAssembly</strong> execution flow for wasm targets.
      </li>
    </ul>
  </div>
</section>

<section>
  <h2 style="margin:0 0 1em 0; text-align:left;">
    Ideation 
  </h2>
  <div style="font-size:1.3em; line-height:1.6; text-align:left;">
    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      Bigger Picture/Goal
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">Implement compiler centric swift-repl</li>
      <li class="fragment fade-up">Plug libSwiftInterpreter with xeus to get xeus-swift</li>
      <li class="fragment fade-up">Theoretically xeus-swift-lite and xeus-swift debugger are both possibl through this approach.</li>
    </ul>

    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      Baby Steps
    </p>
    <ul style="margin:0 0 0 2em; padding:0;">
      <li class="fragment fade-up">Clang-repl being maintained on since the last few years</li>
      <li class="fragment fade-up">Can be understood through an AST dump</li>
      <li class="fragment fade-up">Let me know what you can spot ?</li>
    </ul>
  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.4em; font-weight:700; text-align:center; margin-bottom:0.6em;">
    Clang-repl AST dump
  </h2>

  <!-- Image (dlopen) -->
  <div style="text-align:center;">
    <img src="src/images/ast_dump.png"
         alt="dlopen flow"
         style="max-width:90%; max-height:90vh; display:inline-block; margin:0 auto;
                border-radius:10px; box-shadow:0 8px 28px rgba(0,0,0,.25);" />
  </div>
</section>

<section>
  <h2 style="margin:0 0 1em 0; text-align:left;">
    What can be seen ?
  </h2>
  <div style="font-size:1.3em; line-height:1.6; text-align:left;">
    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      3 TUDECL nodes
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">1 for Builtin, 1 for Runtimes, 1 for Input line 1</li>
      <li class="fragment fade-up">Each TUDECL node has links with the previous node</li>
    </ul>

    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      What was done to achieve this ?
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up"> The concept of PTU was introduced</li>
      <li class="fragment fade-up"> Partial Translation Unit</li>
      <li class="fragment fade-up"> The IncrementalParser was allowed to add TUDECL nodes to the AST Context</li>
    </ul>
  </div>
</section>

<section>
  <h2 style="margin:0 0 1em 0; text-align:left;">
    What was done here ?
  </h2>

  <div style="font-size:1.3em; line-height:1.6; text-align:left;">
    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      Respective changes
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">
        Incremental Parser adds TUDECL node:
        <a href="https://github.com/llvm/llvm-project/blob/0731f18ba9caee809bca43a67d0a4893a147011e/clang/lib/Interpreter/IncrementalParser.cpp#L58-L59"
           target="_blank">link</a>
      </li>
      <li class="fragment fade-up">
        Incremental TU Kind:
        <a href="https://github.com/llvm/llvm-project/blob/907335c00c283e72373d4dd1b86bd057357c7f01/clang/include/clang/AST/ASTContext.h#L1238-L1245"
           target="_blank">link</a>
      </li>
    </ul>
  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.6em; font-weight:800; text-align:center; margin-bottom:0.4em;">
    What happens currently ?
  </h2>

  <!-- Sequential Flow -->
  <div style="font-size:1.4em; text-align:left; color:#222; line-height:1.8; max-width:75%; margin:0 auto;">
    <p class="fragment fade-up"><code>1AST/ASTCONTEXT</code></p>
    <p class="fragment fade-up"><code>→ 1TranslationUnit</code></p>
    <p class="fragment fade-up"><code>→ many Partial Translation Units or PTUs (one per input)</code></p>
  </div>
</section>

<section>
  <h3 style="font-size:2.1em; margin:0 0 1em 0; text-align:left;">
    What is a PTU ?
  </h3>

  <div style="font-size:1.15em; line-height:1.6; text-align:left;">

    <p class="fragment fade-up" style="margin:0 0 1em 0; font-size:1.02em;">
      A Partial Translation Unit (PTU) represents the incremental additions to the AST 
      corresponding to each input line in the REPL.
    </p>
    <ul style="list-style-type: disc; padding-left:1.5em;">
      <li class="fragment fade-up">
        A <strong>Partial Translation Unit (PTU)</strong> corresponds to one user input.
      </li>
      <li class="fragment fade-up">
        Each PTU contains a single <strong>TranslationUnitDecl</strong> node 
        and the <strong>LLVM IR</strong> generated from that input.
      </li>
      <li class="fragment fade-up">
        1 Partial unit -> {1 TUDecl node + the LLVM IR generated from that input}
      </li>
    </ul>

  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.6em; font-weight:800; text-align:center; margin-bottom:0.4em;">
    What happens currently ?
  </h2>

  <!-- Sequential Flow -->
  <div style="font-size:1.4em; text-align:left; color:#222; line-height:1.8; max-width:75%; margin:0 auto;">
    <p class="fragment fade-up"><code>1AST/ASTCONTEXT</code></p>
    <p class="fragment fade-up"><code>→ 1TranslationUnit</code></p>
    <p class="fragment fade-up"><code>→ many Partial Translation Units or PTUs (one per input)</code></p>
    <p class="fragment fade-up"><code>→ Many TUDECL nodes</code></p>
    <p class="fragment fade-up"><code>→ JIT the IR generated</code></p>
  </div>
</section>

<section>
  <h2 style="margin:0 0 1em 0; text-align:left;">
    Baby steps (1st iteration)
  </h2>
  <div style="font-size:1.3em; line-height:1.6; text-align:left;">
    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      Why we shouldn't jump to 2nd iteration straightaway
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">Obviously making changes directly to the fundamental places which isn't recommeding </li>
      <li class="fragment fade-up">Decl.h, ASTContext.h etc</li>
    </ul>

    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      Focus on clang-repl 1st draft
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up"> 1 AST/ASTContext -> 1 TranslationUnit -> 1 TUdecl node</li>
      <li class="fragment fade-up"> Keep track of incoming decls for each delta</li>
      <li class="fragment fade-up"> Generate LLVM IR for those decls</li>
    </ul>
  </div>
</section>

<section>
  <h2 style="font-size:2.4em; font-weight:800; text-align:center; margin-bottom:0.6em;">
    Transaction Class
  </h2>

  <div style="
      max-width:80%;
      margin:0 auto;
      background:#fafafa;
      border-radius:8px;
      box-shadow:0 4px 16px rgba(0,0,0,0.15);
      padding:1em 2em;
      font-size:0.8em;
      line-height:1.5;
      font-family:'Fira Code', monospace;
      color:#111;
      overflow-x:auto;
      white-space:pre;
      text-align:left;      /* ✅ Forces left alignment */
  ">
<code>
/// The class keeps track of various objects created as part of processing
/// incremental inputs.
struct Transaction {
  /// The decls created for the input.
  std::vector&lt;clang::DeclGroupRef&gt; Decls;

  /// The llvm IR produced for the input.
  std::unique_ptr&lt;llvm::Module&gt; TheModule;
};
} // namespace clang
</code>
  </div>
</section>




<section>
  <h2 style="margin:0 0 1em 0; text-align:left;">
    First vs Second Iteration
  </h2>

  <div style="font-size:1.3em; line-height:1.6; text-align:left;">
    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      Commit History
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">
        First Iteration:
        <a href="https://github.com/llvm/llvm-project/commit/44a4000181e1a25027e87f2ae4e71cb876a7a275#diff-065d5a2420c7cd376265089b3086d072b8fea4422ab792ba431209da24aa36fe"
           target="_blank">Commit 44a4000</a>
      </li>
      <li class="fragment fade-up">
        Second Iteration:
        <a href="https://github.com/llvm/llvm-project/commit/11b47c103a36371576711cae1f7527c26f78efb5#diff-3c829117f7bf04282a093494e706d3818825fb01628df71ce0c3e2e4fb5aa261"
           target="_blank">Commit 11b47c1</a>
      </li>
    </ul>

    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      Why the 2nd Iteration
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">Better error recovery</li>
      <li class="fragment fade-up">Isolation of incoming deltas</li>
      <li class="fragment fade-up">Aids debugging for <code>clang-repl</code></li>
      <li class="fragment fade-up">
        Introduces <code>%undo</code> command — enables redefinition and flexible workflows
      </li>
    </ul>
  </div>
</section>

<section>
  <h2 style="margin:0 0 1em 0; text-align:left;">
    Surprise Surprise : We already have the baby
  </h2>

  <div style="font-size:1.3em; line-height:1.6; text-align:left;">
    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      What was present upstream
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">
        A compiler centric REPL
      </li>
      <li class="fragment fade-up">
        Commit:
        <a href="https://github.com/swiftlang/swift/commit/38261ce1f39b2648519f656d5ba2a6764a4f95ad#diff-73992018bbea619aae8603e5987b40a1ff06a3cb2f0a4f3bb1cca8ce134e1fa8"
          target="_blank">
          38261ce
        </a>
      </li>

    </ul>

    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      How this works as per my understanding
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">1AST/ASTCONTEXT -> 1 Module -> 1 ModuleDecl -> 1SourceFile</li>
      <li class="fragment fade-up">SourceFile being incrementally updated with deltas</li>
      <li class="fragment fade-up">PersistantParserstate plays the role of IncrementalParser</li>
      <li class="fragment fade-up">PersistantParserstate -> parseintosourcefile</li>
      <li class="fragment fade-up">-> incrementally generate SILModule -> generate LLVM IR module -> JIT</li>
    </ul>
  </div>
</section>

<section>
  <h2 style="margin:0 0 1em 0; text-align:left;">
    What can we come up with today ?
  </h2>

  <div style="font-size:1.3em; line-height:1.6; text-align:left;">
    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      Swift Immediate based on ORC JIT
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">
        swift -e 'print(1+1)' to get 2 immediately
      </li>
      <li class="fragment fade-up">
        Makes use of EagerSwiftMaterializationUnit
      </li>

    </ul>

    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      How this works as per my understanding
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">1AST/ASTCONTEXT -> 1 Module -> 1 ModuleDecl -> 1SourceFile</li>
      <li class="fragment fade-up">SourceFile being incrementally updated with deltas</li>
      <li class="fragment fade-up">PersistantParserstate plays the role of IncrementalParser</li>
      <li class="fragment fade-up">PersistantParserstate -> parseintosourcefile -> Incrementally generate SILModule</li>
      <li class="fragment fade-up">-> create EagerSwiftMaterializationUnit and use similar toolchain like immediate</li>
    </ul>
  </div>
</section>

<section>
  <h2 style="margin:0 0 1em 0; text-align:left;">
    Transitioning from 1st to 2nd iteration
  </h2>

  <div style="font-size:1.3em; line-height:1.6; text-align:left;">
    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      Why we need it ?
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">
        Understand why having 3 degrees of freedom work better for a REPL
      </li>
      <li class="fragment fade-up">
        Better error recovery and Isolation of incoming deltas
      </li>
      <li class="fragment fade-up">
        Helps in future like implement features like Debugger Support
      </li>
      <li class="fragment fade-up">
        We are JITTing a SIL Module which doesn't identify uniquely like a LLVM Module
      </li>

    </ul>
  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.4em; font-weight:700; text-align:center; margin-bottom:0.6em;">
    Error recovery
  </h2>

  <!-- Image (timeit gif) -->
  <div style="text-align:center;">
    <img src="src/images/error_recovery.png"
         alt="Timeit magic demo"
         style="max-width:70%; max-height:auto; display:inline-block; margin:0 auto;
                border-radius:10px; box-shadow:0 8px 28px rgba(0,0,0,.25);" />
  </div>
</section>

<section>
  <!-- Title -->
  <h2 style="font-size:2.4em; font-weight:700; text-align:center; margin-bottom:0.6em;">
    Debugger Support
  </h2>

  <!-- Image (timeit gif) -->
  <div style="text-align:center;">
    <img src="src/images/debug_pic.png"
         alt="Timeit magic demo"
         style="max-width:70%; max-height:auto; display:inline-block; margin:0 auto;
                border-radius:10px; box-shadow:0 8px 28px rgba(0,0,0,.25);" />
  </div>
</section>

<section>
  <h2 style="margin:0 0 1em 0; text-align:left;">
    Comparing 1st vs 2nd iteration
  </h2>

  <div style="font-size:1.3em; line-height:1.6; text-align:left;">
    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      First Iteration
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">1AST/ASTCONTEXT -> 1 Module -> 1 ModuleDecl -> 1SourceFile</li>
      <li class="fragment fade-up">PersistantParserstate -> parseintosourcefile -> Incrementally generate SILModule</li>
      <li class="fragment fade-up">-> create EagerSwiftMaterializationUnit and use similar toolchain like immediate</li>
    </ul>

    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      Second Iteration
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">1AST/ASTCONTEXT -> 1 Module -> 1 ModuleDecl -> 1SourceFile</li>
      <li class="fragment fade-up">1SourceFile gives us many PartialSourceFiles (so PSF just like PTU)</li>
      <li class="fragment fade-up">1 Partial one -> {1 SourceFile per input + incremental SIL Module generated}</li>
      <li class="fragment fade-up">-> create EagerSwiftMaterializationUnit and use similar toolchain like immediate</li>
    </ul>
  </div>
</section>

<section>
  <h2 style="margin:0 0 1em 0; text-align:left;">
    Comparing 1st vs 2nd iteration
  </h2>

  <div style="font-size:1.3em; line-height:1.6; text-align:left;">
    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      Second Iteration
    </p>
    <ul style="margin:0 0 1.5em 2em; padding:0;">
      <li class="fragment fade-up">PR : https://github.com/swiftlang/swift/pull/77666 </li>
      <li class="fragment fade-up">We might want to allow adding sourcefiles after moduledecl creation only if they are of type REPL</li>
    </ul>
  </div>
</section>

<section>
  <h2 style="margin:0 0 1em 0; text-align:left;">
    Roadmap
  </h2>

  <div style="font-size:1.3em; line-height:1.6; text-align:left;">
    
    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      1) Revamp compiler-centric PR
    </p>
    <ul style="margin:0 1.5em 1em 2em; padding:0;">
      <li class="fragment fade-up">
        Integrate <code>EagerMaterializationUnit</code> through ORC JIT.
      </li>
    </ul>

    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      2) Improve it to have an Interpreter-like structure
    </p>
    <ul style="margin:0 1.5em 1em 2em; padding:0;">
      <li class="fragment fade-up">
        Move towards an Interpreter-like architecture (<code>libswiftInterpreter</code>).
      </li>
      <li class="fragment fade-up">
        Define key classes:
        <ul style="margin:0.4em 0 0 1.5em;">
          <li><code>Interpreter</code></li>
          <li><code>IncrementalParser</code> — maintains persistent parser state</li>
          <li><code>IncrementalExecutor</code> — handles JIT for native and Wasm execution</li>
        </ul>
      </li>
    </ul>
  </div>
</section>

<section>
  <h2 style="margin:0 0 1em 0; text-align:left;">
    Roadmap
  </h2>

  <div style="font-size:1.3em; line-height:1.6; text-align:left;">
    <p class="fragment fade-up" style="font-weight:600; margin:0 0 .4em 0;">
      3) This should be enough to come up with <code>xeus-swift</code>
    </p>

    <p class="fragment fade-up" style="font-weight:600; margin:1em 0 .4em 0;">
      4) Split the work
    </p>
    <ul style="margin:0 1.5em 1em 2em; padding:0;">
      <li class="fragment fade-up">
        Some can focus on compiling <code>swift-repl</code> and <code>xeus-swift</code> to Wasm for <code>xeus-swift-lite</code>.
      </li>
      <li class="fragment fade-up">
        Some can work on moving from <code>swift-repl</code> version 1 → version 2 (enabling the 3rd degree of freedom).
      </li>
      <li class="fragment fade-up">
        Add tests using a framework similar to <code>clang-repl</code> on LLVM (<code>clangInterpreterTests</code>).
      </li>
    </ul>

    <p class="fragment fade-up" style="font-weight:600; margin:1em 0 .4em 0;">
      5) Last effort
    </p>
    <ul style="margin:0 1.5em 1em 2em; padding:0;">
      <li class="fragment fade-up">
        Implement debugger support for <code>xeus-swift</code>.
      </li>
    </ul>
  </div>
</section>
      </div>
		</div>
  </body>
</html>
